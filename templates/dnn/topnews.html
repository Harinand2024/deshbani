{% load static %}
<div class="container my-3">
  <div class="row">
    <!-- ================= LEFT SECTION (col-9): News Content ================= -->
    <div class="col-lg-9 col-md-12">

      <!-- ðŸŒ Slider + Two Ads Row -->
      <div class="row mb-4">
        <!-- ðŸ“° Slider -->
        <div class="col-lg-6 col-md-12 ">
          <section class="dxbindia-slider">
            <div id="dxbindiaNewsCarousel" class="carousel slide carousel-fade" data-bs-ride="carousel" data-bs-interval="4000">

              <!-- Indicators -->
              <div class="carousel-indicators">
                {% for news in LatestNews %}
                <button type="button" data-bs-target="#dxbindiaNewsCarousel" data-bs-slide-to="{{ forloop.counter0 }}"
                  class="{% if forloop.first %}active{% endif %}"></button>
                {% endfor %}
              </div>

              <!-- Slides -->
              <div class="carousel-inner rounded-4 overflow-hidden card-bg-dark shadow-sm">
                {% for news in LatestNews %}
                <div class="carousel-item {% if forloop.first %}active{% endif %}">
                  <div class="ratio ratio-16x9">
                    {% if news.video_file %}
                    <video class="w-100 h-100 object-fit-cover" preload="none" loop playsinline autoplay muted>
                      <source src="{{ news.video_file.url }}" type="video/mp4">
                    </video>
                    {% else %}
                    <a href="/{{ news.slug }}">
                      <img src="{{ news.post_image.url }}" alt="{{ news.post_title }}" class="img-fluid w-100 h-100 object-fit-cover" loading="lazy">
                    </a>
                    {% endif %}
                  </div>
                  <div class="dxbindia-slide-overlay d-flex flex-column justify-content-end p-4">
                    <div class="d-flex align-items-center mb-2">
                      <span class="badge bg-danger me-2">Latest</span>
                      <span class="text-light small">{{ news.post_date }}</span>
                    </div>
                    <h5 class="text-white fw-semibold mb-4 text-truncate-2">
                      <a href="/{{ news.slug }}" class="text-white text-decoration-none">
                        {{ news.post_title|truncatechars:180 }}
                      </a>
                    </h5>
                  </div>
                </div>
                {% endfor %}
              </div>

              <!-- Controls -->
              <button class="carousel-control-prev" type="button" data-bs-target="#dxbindiaNewsCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon bg-dark rounded-circle p-3"></span>
              </button>
              <button class="carousel-control-next" type="button" data-bs-target="#dxbindiaNewsCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon bg-dark rounded-circle p-3"></span>
              </button>
            </div>
          </section>
        </div>

       <!-- ðŸ“° 2 Latest News Beside Slider -->
        <div class="col-lg-6 col-md-12">
          <div class="row">

            <!-- News 1 -->
            <div class="col-md-6">
              {% for Blog in LatestNews|slice:"0:1" %}
              <div class="card-bg-dark shadow-sm border rounded h-100">
                <a href="/{{ Blog.slug }}">
                  <img src="{{ Blog.post_image.url }}" alt="{{ Blog.post_title }}" class="rounded-top img-fluid" loading="lazy">
                </a>
                <div class="py-3 px-2">
                  <a href="/{{ Blog.slug }}" class="text-decoration-none">
                    <div class="fw-semibold small hover-title">{{ Blog.post_title|truncatechars:60 }}</div>
                  </a>
                  <div class="small mt-2 d-flex align-items-center">
                    <span>{{ Blog.schedule_date }}</span>
                    <div class="mx-2">
                      {% include 'share.html' with posts=Blog %}
                    </div>
                  </div>
                </div>
              </div>
              {% endfor %}
            </div>

            <!-- News 2 -->
            <div class="col-md-6">
              {% for Blog in LatestNews|slice:"1:2" %}
              <div class="card-bg-dark shadow-sm border rounded h-100">
                <a href="/{{ Blog.slug }}">
                  <img src="{{ Blog.post_image.url }}" alt="{{ Blog.post_title }}" class="rounded-top img-fluid" loading="lazy">
                </a>
                <div class="py-3 px-2">
                  <a href="/{{ Blog.slug }}" class="text-decoration-none">
                    <div class="fw-semibold small hover-title">{{ Blog.post_title|truncatechars:60 }}</div>
                  </a>
                  <div class="small mt-2 d-flex align-items-center">
                    <span>{{ Blog.schedule_date }}</span>
                    <div class="mx-2">
                      {% include 'share.html' with posts=Blog %}
                    </div>
                  </div>
                </div>
              </div>
              {% endfor %}
            </div>

          </div>
        </div>
      </div>

      <!-- ðŸŒŸ Top Stories + 2 More News -->
      <div class="row mb-4">
        <!-- Top Stories -->
        <div class="col-lg-4 col-md-6">
          <div class="card-bg-dark shadow-sm border top-stories-widget h-100">
            <div class="card-header border-0 d-flex align-items-center p-1">
              
              <h6 class="mb-0 fw-bold text-danger">Top Stories</h6>
            </div>
            <div class="p-2">
              {% for Blog in trendpost|slice:"0:3" %}
              <div class="d-flex align-items-center mb-3 story-item">
                <a href="/{{ Blog.slug }}" class="me-2">
                  <img src="{{ Blog.post_image.url }}" alt="{{ Blog.post_title }}" class="rounded story-img" loading="lazy">
                </a>
                <div class="flex-grow-1">
                  <a href="/{{ Blog.slug }}" class="text-decoration-none">
                    <div class="fw-semibold hover-title">{{ Blog.post_title|truncatechars:40 }}</div>
                  </a>
                  <div class=" small mt-1 d-flex align-items-center">
                    <span class="">{{ Blog.schedule_date }}</span>
                    <div class="mx-2" style="--custom-bottom: 0px; --custom-right: 0px;">
                    {% include 'share.html' with posts=post %}
                  </div>
                  </div>
                </div>
              </div>
              {% endfor %}
            </div>
          </div>
        </div>

        <!-- Two More News -->
        <div class="col-lg-8 col-md-6">
          <div class="row">
            <!-- News 3 -->
            <div class="col-md-6">
              {% for Blog in trendpost|slice:"3:4" %}
              <div class="card-bg-dark shadow-sm border rounded h-100">
                <a href="/{{ Blog.slug }}">
                  <img src="{{ Blog.post_image.url }}" alt="{{ Blog.post_title }}" class="rounded-top img-fluid" loading="lazy">
                </a>
                 <div class="py-3 px-2">
                  <a href="/{{ Blog.slug }}" class="text-decoration-none">
                    <div class="fw-semibold small hover-title">{{ Blog.post_title|truncatechars:110 }}</div>
                  </a>
                  <div class="small mt-2 d-flex align-items-center">
                    <span class="">{{ Blog.schedule_date }}</span>
                    <div class="mx-2" style="--custom-bottom: 0px; --custom-right: 0px;">
                    {% include 'share.html' with posts=post %}
                  </div>
                  </div>
                  
                </div>
              </div>
              {% endfor %}
            </div>

            <!-- News 4 -->
            <div class="col-md-6">
              {% for Blog in trendpost|slice:"4:5" %}
              <div class="card-bg-dark shadow-sm border rounded h-100">
                <a href="/{{ Blog.slug }}">
                  <img src="{{ Blog.post_image.url }}" alt="{{ Blog.post_title }}" class="rounded-top img-fluid" loading="lazy">
                </a>
                <div class="py-3 px-2">
                  <a href="/{{ Blog.slug }}" class="text-decoration-none">
                    <div class="fw-semibold small hover-title">{{ Blog.post_title|truncatechars:110 }}</div>
                  </a>
                  <div class="small mt-2 d-flex align-items-center">
                    <span class="">{{ Blog.schedule_date }}</span>
                    <div class="mx-2" style="--custom-bottom: 0px; --custom-right: 0px;">
                    {% include 'share.html' with posts=post %}
                  </div>
                  </div>
                  
                </div>
              </div>
              {% endfor %}
            </div>
          </div>
        </div>
      </div>

      <!-- ðŸŒŸ Top Breaking News + 2 More News -->
        <div class="row mb-4">
          <!-- Top Stories -->
          <div class="col-lg-4 col-md-6">
            <div class="card-bg-dark shadow-sm border top-stories-widget h-100">
              <div class="card-header border-0 d-flex align-items-center p-1">
                
                <h6 class="mb-0 fw-bold text-danger">Breaking News</h6>
              </div>
              <div class="p-2">
                {% for Blog in bnews|slice:"0:3" %}
                <div class="d-flex align-items-center mb-3 story-item">
                  <a href="/{{ Blog.slug }}" class="me-2">
                    <img src="{{ Blog.post_image.url }}" alt="{{ Blog.post_title }}" class="rounded story-img" loading="lazy">
                  </a>
                  <div class="flex-grow-1">
                    <a href="/{{ Blog.slug }}" class="text-decoration-none">
                      <div class="fw-semibold hover-title">{{ Blog.post_title|truncatechars:40 }}</div>
                    </a>
                    <div class="small mt-1 d-flex align-items-center">
                      <span class="">{{ Blog.schedule_date }}</span>
                      <div class="mx-2" style="--custom-bottom: 0px; --custom-right: 0px;">
                        {% include 'share.html' with posts=Blog %}
                      </div>
                    </div>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
          </div>

          <!-- Two More News -->
          <div class="col-lg-8 col-md-6">
            <div class="row">
              <!-- News 3 -->
              <div class="col-md-6">
                {% for Blog in bnews|slice:"3:4" %}
                <div class="card-bg-dark shadow-sm border rounded h-100">
                  <a href="/{{ Blog.slug }}">
                    <img src="{{ Blog.post_image.url }}" alt="{{ Blog.post_title }}" class="rounded-top img-fluid" loading="lazy">
                  </a>
                  <div class="py-3 px-2">
                    <a href="/{{ Blog.slug }}" class="text-decoration-none">
                      <div class="fw-semibold small hover-title">{{ Blog.post_title|truncatechars:110 }}</div>
                    </a>
                    <div class="small mt-2 d-flex align-items-center">
                      <span class="">{{ Blog.schedule_date }}</span>
                      <div class="mx-2" style="--custom-bottom: 0px; --custom-right: 0px;">
                        {% include 'share.html' with posts=Blog %}
                      </div>
                    </div>
                  </div>
                </div>
                {% endfor %}
              </div>

              <!-- News 4 -->
              <div class="col-md-6">
                {% for Blog in bnews|slice:"4:5" %}
                <div class="card-bg-dark shadow-sm border rounded h-100">
                  <a href="/{{ Blog.slug }}">
                    <img src="{{ Blog.post_image.url }}" alt="{{ Blog.post_title }}" class="rounded-top img-fluid" loading="lazy">
                  </a>
                  <div class="py-3 px-2">
                    <a href="/{{ Blog.slug }}" class="text-decoration-none">
                      <div class="fw-semibold small hover-title">{{ Blog.post_title|truncatechars:110 }}</div>
                    </a>
                    <div class="small mt-2 d-flex align-items-center">
                      <span class="">{{ Blog.schedule_date }}</span>
                      <div class="mx-2" style="--custom-bottom: 0px; --custom-right: 0px;">
                        {% include 'share.html' with posts=Blog %}
                      </div>
                    </div>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
        </div>


    </div>

    <!-- ================= RIGHT SECTION (col-3): Ads Sidebar ================= -->
    <div class="col-lg-3 col-md-12">
      <!-- Top Stories -->
      
          <div class="card-bg-dark shadow-sm border rounded top-stories-widge mb-3">
            <div class="card-header border-0 d-flex align-items-center p-1">
              
              <h6 class="mb-0 fw-bold text-danger">Top Headline</h6>
            </div>
            <div class="p-2">
              {% for Blog in headline|slice:"0:3" %}
              <div class="d-flex align-items-center mb-3 story-item">
                <a href="/{{ Blog.slug }}" class="me-2">
                  <img src="{{ Blog.post_image.url }}" alt="{{ Blog.post_title }}" class="rounded story-img" loading="lazy">
                </a>
                <div class="flex-grow-1">
                  <a href="/{{ Blog.slug }}" class="text-decoration-none">
                    <div class="fw-semibold hover-title">{{ Blog.post_title|truncatechars:40 }}</div>
                  </a>
                  <div class=" small mt-1 d-flex align-items-center">
                    <span class="">{{ Blog.schedule_date }}</span>
                    <div class="mx-2" style="--custom-bottom: 0px; --custom-right: 0px;">
                    {% include 'share.html' with posts=post %}
                  </div>
                  </div>
                </div>
              </div>
              {% endfor %}
            </div>
          </div>
        
      <aside class="ads-sidebar">
        {% include 'allads.html' %}
      </aside>
    
    </div>
  </div>
</div>



<!-- Slick Slider CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css" />

<!-- jQuery & Slick JS -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
<script src="https://www.youtube.com/iframe_api"></script> <!-- YouTube Iframe API -->

<script>
  let players = [];
  let swiper;

  // âœ… YouTube API Ready
  function onYouTubeIframeAPIReady() {
    const iframes = document.querySelectorAll('.video-iframe');
    iframes.forEach((iframe, index) => {
      players[index] = new YT.Player(iframe, {
        events: {
          'onReady': onPlayerReady,
          'onStateChange': onPlayerStateChange
        }
      });
    });
  }

  // âœ… Pause all at start, play first muted
  function onPlayerReady(event) {
    players.forEach(player => player && player.pauseVideo());
    if (players[0]) {
      players[0].mute();
      players[0].playVideo();
    }
  }

  // âœ… On video end â†’ move to next slide
  function onPlayerStateChange(event) {
    if (event.data === YT.PlayerState.ENDED) {
      // ðŸ›  Added safety check
      if (typeof swiper !== "undefined" && swiper.slideNext) {
        goToNextSlide();
      }
    }
  }

  // âœ… Safe next slide
  function goToNextSlide() {
    if (!swiper) return;
    swiper.slideNext();
    playCurrentSlideVideo();
  }

  // âœ… Safe prev slide
  function goToPrevSlide() {
    if (!swiper) return;
    swiper.slidePrev();
    playCurrentSlideVideo();
  }

  // âœ… Play only active slideâ€™s video
  function playCurrentSlideVideo() {
    const currentIndex = swiper ? swiper.realIndex : 0;
    players.forEach(p => p && p.pauseVideo && p.pauseVideo());
    setTimeout(() => {
      if (players[currentIndex]) {
        players[currentIndex].mute();
        players[currentIndex].playVideo();
      }
    }, 500);
  }

  // âœ… Initialize Swiper safely after DOM load
  document.addEventListener('DOMContentLoaded', function () {
    swiper = new Swiper('.trending-swiper', {
      loop: true,
      autoplay: false,
      on: {
        slideChange: playCurrentSlideVideo
      }
    });

    // Buttons (only if exist)
    const nextBtn = document.getElementById('skipBtn');
    const prevBtn = document.getElementById('prevBtn');

    if (nextBtn) nextBtn.addEventListener('click', goToNextSlide);
    if (prevBtn) prevBtn.addEventListener('click', goToPrevSlide);
  });
</script>


<!-- Initialize Slider -->
<script>
  $(document).ready(function () {
    $('.hnews-slider').slick({
      autoplay: true,
      autoplaySpeed: 3000,
      arrows: false,
      dots: true,
      infinite: true,
      speed: 500,
      slidesToShow: 1,
      slidesToScroll: 1,
      adaptiveHeight: true
    });
  });
</script>

<style>
  .title1 {
    font-weight: 600;
    font-size: 1rem;
    text-transform: uppercase;
  }

  .title1 a {
    text-decoration: none !important;
  }

  .title1 a:hover {
    text-decoration: none !important;
    color: #ed1c24 !important;
  }


  /* Slider wrapper */
.dxbindia-slider {
  position: relative;
  border-radius: 20px;
  overflow: hidden;
}

/* Overlay gradient */
.dxbindia-slide-overlay {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  background: linear-gradient(to top, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0));
  padding: 20px;
}

/* Title truncate */
.text-truncate-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Indicators */
.carousel-indicators [data-bs-target] {
  background-color: #fff;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  opacity: 0.6;
}

.carousel-indicators .active {
  opacity: 1;
}

/* Controls */
.carousel-control-prev-icon,
.carousel-control-next-icon {
  background-size: 60%, 60%;
}

/* ðŸŸ¢ Fix: No white/black blank between slides */
.carousel-inner {
  position: relative;
  overflow: hidden;
  background: transparent !important;
}

/* Slides stay stacked to avoid flicker */
.carousel-item {
  position: absolute;
  top: 0;
  left: 0;
  opacity: 0;
  transition: opacity 0.5s ease-in-out;
  width: 100%;
  display: block;
}

.carousel-item.active {
  position: relative;
  opacity: 1;
  z-index: 2;
}

/* Image & video fix */
.carousel-item img,
.carousel-item video {
  width: 100%;
  height: 100%;
  object-fit: cover;
  background: transparent !important;
}

/* Prevent flicker on lazy load */
.carousel,
.carousel-item,
.carousel-inner {
  background: transparent !important;
}


  .top-stories-widget {
    width: 100%;
    max-width: 320px;
    /* match Google News card width */
    border-radius: 12px;
  }

  .story-item {
    cursor: pointer;

  }



  .story-img {
    width: 110px;
    height: 60px;
    object-fit: cover;
  }
.hover-title {
    text-decoration: none;
   font-size: 14px  !important;
   
  }
  .hover-title:hover {
    text-decoration: none;
    color: #ed1c24 !important;
  }


  @media (max-width: 768px) {
    .dxbindia-slide-overlay {
      padding: 15px;
    }
  }
</style>